# CHAPTER 2 – EIGRP (Enhanced Interior Gateway Routing Protocol)

---
# 1. FUNDAMENTOS DE EIGRP  

EIGRP es un protocolo **híbrido** (denominado "Advanced Distance Vector") que combina:

- Algoritmos vector-distancia (como RIP)
    
- Características de enlace-estado (convergencia rápida)
    
- El algoritmo DUAL (Diffusing Update Algorithm)
    

Características esenciales:

- Convergencia muy rápida
    
- Soporta VLSM, CIDR
    
- Métrica compuesta
    
- Envío de actualizaciones parciales y sólo cuando hay cambios
    
- Utiliza multicast 224.0.0.10 (IPv4) y FF02::A (IPv6)
    
- Seguridad mediante autenticación MD5 o SHA-256
    
- Soporta load-balancing ECMP y unequal-cost (con "variance")
    

EIGRP se usa ampliamente en entornos empresariales por su eficiencia y estabilidad.

---
# 2. AUTONOMOUS SYSTEMS (EIGRP PROCESS)

EIGRP agrupa routers bajo un número común llamado **Autonomous System (AS)**.

Ejemplo:

`router eigrp 100`

Todos los routers deben compartir:

- Mismo AS
    
- Mismo K-values
    
- Coincidencia en subredes conectadas
    

Si alguno de estos difiere, no formarán adyacencia.

---
# 3. TERMINOLOGÍA OFICIAL DE EIGRP

### Feasible Distance (FD)

Métrica total hacia un destino usando la ruta actual instalada.

### Reported Distance (RD)

Métrica que un vecino reporta hacia ese destino.

### Successor

La mejor ruta hacia un destino (ruta activa en la FIB).

### Feasible Successor

Ruta de respaldo que cumple la condición de factibilidad:

```
RD < FD(successor)
```

Regla crucial para examen ENARSI.

### Advertised Distance (AD)

Sinónimo práctico de Reported Distance en Cisco IOS.

---
# 4. TOPOLOGY TABLE (VISIÓN PROFESIONAL)

Cada router mantiene:

1. **Neighbor Table**  
    Lista de vecinos EIGRP.
    
2. **Topology Table**  
    Todos los destinos aprendidos de los vecinos con _todas_ sus rutas posibles (successor y feasible successors).
    
3. **Routing Table**  
    Solo las rutas finales seleccionadas (successors).
    

Ejemplo CLI:

```
show ip eigrp topology 
show ip eigrp topology all-links
```

---
# 5. EIGRP NEIGHBORS – FORMACIÓN DE ADYACENCIAS

Para que dos routers formen adyacencia EIGRP deben coincidir en:

- AS number
    
- K-values
    
- Subred contigua
    
- No estar configurados como passive-interface
    
- MTU coherente (no estrictamente igual, pero diferencias severas causan inconsistencias)
    
- Sin ACL bloqueando 224.0.0.10 UDP/88
    

Comando:

```
show ip eigrp neighbors
```

Campos críticos:

- Hold Time
    
- SRTT (Smooth Round Trip Timer)
    
- RTO (Retransmission Timeout)
    

Problemas frecuentes:

- Passive-interface oculto
    
- MTU mismatch
    
- Falta de red bajo “network”
    
- AS incorrecto
    

---
# 6. INTER-ROUTER COMMUNICATION

EIGRP usa:

- **Hello packets** (descubrimiento)
    
- **Update packets** (solo cambios)
    
- **Query** (cuando no existe successor ni FS)
    
- **Reply** (respuesta a Query)
    
- **Ack** (confirmación)
    

Formato:

```
Hello, Update → multicast 
Query, Reply, Ack → unicast
```

---
# 7. EIGRP CONFIGURATION MODES

Cisco soporta dos modos:

---

### 7.1 Classic Mode (tradicional)

---

```
router eigrp 100  
network 10.0.0.0 0.0.0.255  
no auto-summary
```

---

### 7.2 Named Mode (recomendado)

---

```
router eigrp EIGRP-AS
 address-family ipv4 autonomous-system 100
  af-interface GigabitEthernet0/0
   passive-interface
  exit-af-interface
  topology base
 exit-address-family
```

Ventajas:

- Unifica configuración IPv4/IPv6
    
- Más limpio en topologías complejas
    
- Soporta af-interface para parámetros granulares
    

---
# 8. NETWORK STATEMENT – CÓMO FUNCIONA REALMENTE

En IPv4 Classic Mode:

```
network <ip> <wildcard>
```

La wildcard selecciona interfaces cuyo **IP primario** coincide.

Ejemplo:

```
network 192.168.10.0 0.0.0.255
```

Incluye la interfaz 192.168.10.1/24.

No incluye direcciones secundarias.

---
# 9. CONFIRMANDO INTERFACES Y VECINOS

```
show ip eigrp interfaces
show ip eigrp neighbors
show ip protocols
```

En IPv6:

```
show ipv6 eigrp neighbors
```

---
# 10. DISPLAYING INSTALLED ROUTES

```
show ip route eigrp
```

Formato:

```
D   10.1.1.0/24 [90/30720] via 192.168.1.2
```

Donde:

- 90 = Administrative Distance
    
- 30720 = Feasible Distance
    

---
# 11. ROUTER-ID

Orden de selección:

1. Configurado manualmente:
    
```
router eigrp 100  
eigrp router-id 1.1.1.1
```
    
2. Highest loopback IPv4
    
3. Highest physical IPv4
    

EIGRPv6 **requiere Router-ID** (similar a OSPFv3).

---
# 12. PASSIVE INTERFACES

Evita formar vecinos pero anuncia la red.

```
passive-interface GigabitEthernet0/1
```

O hacer todas pasivas y luego excluir:

```
passive-interface default 
no passive-interface GigabitEthernet0/0
```

---
# 13. AUTHENTICATION – SEGURIDAD EIGRP

EIGRP soporta:

- MD5
    
- SHA-256 (IOS 15+)
    

---

### Configuración Keychain (IPv4)

---

```
key chain EIGRP_KEYS
 key 1
  key-string cisco123
```

Activación:

```
interface g0/0
 ip authentication mode eigrp 100 md5
 ip authentication key-chain eigrp 100 EIGRP_KEYS
```

---
# 14. PATH METRIC CALCULATION – MÉTRICA PROFESIONAL

Métrica clásica (K-values por defecto):

```
metric = 256 * (BW + Delay)
```

Donde:

```
BW = 10^7 / min_bandwidth (kbps)
Delay = sum of delays / 10
```

Ejemplo:

```
BW = 100 Mbps → min BW = 100000 kbps
BW term = 10^7 / 100000 = 100

Delay = 10000 + 10000 = 20000 μs
Delay term = 20000 / 10 = 2000

Métrica = 256 * (100 + 2000) = 256 * 2100 = 537600
```

---
# 15. WIDE METRICS – NECESARIO PARA 10G, 40G, 100G

Wide Metrics se introdujo para soportar enlaces modernos.

Beneficios:

- Soporta BW hasta 10^12
    
- Mejora cálculo de delay
    
- Requerido para EIGRP Named Mode en algunos diseños
    

Activación:

```
router eigrp NAME
 address-family ipv4 autonomous-system 100
  metric weights 0 1 0 1 0 0
```

---
# 16. K VALUES – PROFUNDIDAD

Por defecto:

```
K1 (bandwidth) = 1
K2 (load)      = 0
K3 (delay)     = 1
K4 = 0
K5 = 0
```

Todos los routers deben coincidir en sus K-values.  
De lo contrario, **no habrá adyacencia**.

---
# 17. LOAD BALANCING – EQUAL & UNEQUAL COST

### 17.1 ECMP – Equal Cost

Habilitado por defecto.

Máximo: 32 rutas paralelas.

```
maximum-paths 8
```

### 17.2 Unequal-Cost Load Balancing (Variance)

EIGRP es el único IGP clásico que soporta esto.

```
variance <n>
```

Condición:

```
FD(alternate) ≤ FD(successor) * variance
```

Ejemplo:

```
FD(successor) = 1000
FD(alternate) = 2200
variance = 3

1000 * 3 = 3000 → 2200 califica
```
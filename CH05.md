# Chapter 5 – EIGRPv6 (Advanced ENARSI Edition)

---

# 1. EIGRPv6 Fundamentals

EIGRPv6 es esencialmente EIGRP para IPv6, con estas diferencias claves:

1. No usa `network statements`.  
2. Se activa **por interfaz**, nunca mediante network.  
3. Requiere que la interfaz esté en **up/up** y habilitada para IPv6.  
4. Usa multicast IPv6 FF02::A (link-local scope).  
5. Requiere un router-id configurado manualmente o heredado de IPv4.  
6. Las adyacencias siempre se establecen con direcciones **link-local**.  
7. El proceso está desactivado globalmente hasta ejecutar:  
   ```
   ipv6 router eigrp <AS>
    no shutdown
   ```

Puertos:
- Protocolo 88, igual que EIGRP para IPv4.

---

# 2. EIGRPv6 Inter-Router Communication

Mensajes:
- Hello (descubrir vecinos)
- Update (rutas)
- Query / Reply (DUAL)
- Ack (confirmaciones)

Transportado sobre IPv6 en multicast FF02::A.

Ver los Hellos:
```
debug eigrp packets hello
```

Ver vecinos:
```
show ipv6 eigrp neighbors
```

---

# 3. EIGRPv6 Configuration

Requisitos:
1. IPv6 habilitado globalmente:
   ```
   ipv6 unicast-routing
   ```
2. Crear proceso:
   ```
   ipv6 router eigrp 100
    router-id 1.1.1.1
    no shutdown
   ```
3. Activar por interfaz:
   ```
   interface g0/0
    ipv6 eigrp 100
   ```

---

# 4. EIGRPv6 Classic Mode Configuration

Ejemplo clásico:
```
ipv6 unicast-routing

ipv6 router eigrp 100
 router-id 1.1.1.1
 no shutdown

interface g0/0
 ipv6 address 2001:DB8:1:1::1/64
 ipv6 eigrp 100

interface g0/1
 ipv6 address 2001:DB8:1:2::1/64
 ipv6 eigrp 100
```

Ver Topología:
```
show ipv6 eigrp topology
```

---

# 5. EIGRPv6 Named Mode Configuration

A partir de IOS 15.x se recomienda Named Mode.

Ejemplo:
```
router eigrp ENTERPRISE
 address-family ipv6 unicast autonomous-system 100
  af-interface default
   passive-interface
  exit-af-interface

  af-interface g0/0
   no passive-interface
  exit-af-interface

  topology base
  exit-af-interface
 exit-address-family
```

Ver configuración:
```
show run | section eigrp
```

---

# 6. EIGRPv6 Verification

Comandos clave:
```
show ipv6 eigrp neighbors
show ipv6 eigrp interfaces
show ipv6 route eigrp
show ipv6 eigrp topology
```

Ver router-id:
```
show ipv6 eigrp topology | include Router-ID
```

---

# 7. IPv6 Route Summarization

EIGRPv6 permite sumarización por interfaz:
```
interface g0/0
 ipv6 summary-address eigrp 100 2001:DB8:10::/48
```

Genera automáticamente:
- Ruta resumen
- Ruta Null0 para evitar loops

Ver resumen:
```
show ipv6 eigrp topology
```

---

# 8. Default Route Advertising

EIGRPv6 permite inyectar ::/0:

```
ipv6 route ::/0 2001:DB8:FF::1

ipv6 router eigrp 100
 redistribute static
```

O vía named mode:
```
router eigrp CORE
 address-family ipv6 unicast
  redistribute static
 ```
Verificación:
```
show ipv6 route eigrp | include ::/0
```

---

# 9. Route Filtering

Métodos soportados:
- distribute-lists (prefix-list)
- route-maps
- ACLv6

Ejemplo:
```
ipv6 prefix-list BLOCKv6 deny 2001:DB8:100::/48
ipv6 prefix-list BLOCKv6 permit ::/0 le 128

ipv6 router eigrp 100
 distribute-list prefix BLOCKv6 in g0/1
```

---

# 10. Troubleshooting EIGRPv6 Neighbor Issues

---

## 10.1 Interface Is Down
```
show ipv6 interface g0/0
show ip interface brief
```
Solución:
```
interface g0/0
 no shutdown
```

---

## 10.2 Mismatched Autonomous System Numbers

EIGRPv6 todavía requiere que AS coincida:
```
ipv6 router eigrp 100
```

Verificación:
```
show ipv6 eigrp interfaces detail
```

---

## 10.3 Mismatched K Values

Debe coincidir entre vecinos.
```
show ipv6 protocols
```

---

## 10.4 Passive Interfaces

Si una interfaz está en passive → no se envían Hellos.

Classic:
```
ipv6 router eigrp 100
 no passive-interface g0/0
```

Named Mode:
```
router eigrp CORE
 address-family ipv6 unicast
  af-interface g0/0
   no passive-interface
```

---

## 10.5 Mismatched Authentication

Ejemplo MD5:
```
key chain EIGRPv6_KEYS
 key 1
  key-string clave123

interface g0/0
 ipv6 authentication mode eigrp 100 md5
 ipv6 authentication key-chain eigrp 100 EIGRPv6_KEYS
```

Verificación:
```
debug eigrp packets hello
```

---

## 10.6 Timers

EIGRPv6 timers no tienen que coincidir, pero valores extremos causan neighborship flapping.

Ver:
```
show ipv6 eigrp neighbors
```

---

## 10.7 Interface Not Participating in Routing Process

Recordatorio:
EIGRPv6 no usa network statements, así que la interfaz debe tener:
```
ipv6 eigrp 100
```

---

## 10.8 ACLs

ACLs IPv6 pueden bloquear Hellos:
```
ipv6 access-list BLOCK
 deny ipv6 any ff02::a
```

Verificar:
```
show ipv6 access-list
```

---

# 11. Troubleshooting EIGRPv6 Routes

---

## 11.1 Interface Not Participating in the Routing Process

Falta este comando:
```
interface g0/1
 ipv6 eigrp 100
```

---

## 11.2 Better Source of Information

AD para IPv6:
- Connected: 0
- Static: 1
- EIGRPv6 internal: 90
- External: 170
- OSPFv3: 110

Diagnóstico:
```
show ipv6 route <prefix>
```

---

## 11.3 Route Filtering

Si la ruta no aparece:
```
show ipv6 protocols
show run | section distribute
```

---

## 11.4 Stub Configuration

Stub evita flooding innecesario.

Config:
```
ipv6 router eigrp 100
 eigrp stub connected summary
```

Ver:
```
show ipv6 eigrp neighbors detail
```

---

## 11.5 Split Horizon

Afecta redes NBMA/DMVPNv6.

Deshabilitar:
```
interface Tunnel0
 no ipv6 split-horizon eigrp 100
```

---

# 12. Troubleshooting Named EIGRP

Named mode tiene subniveles:
- af-interface
- address-family
- topology

Errores comunes:
- Configuración en el modo equivocado.
- Falta de `exit-af-interface`.

Verificación:
```
show run | section eigrp
```

Ver vecinos en named:
```
show eigrp address-family ipv6 neighbors
```

---

# 13. EIGRPv6 and Named EIGRP Trouble Tickets

---

## Trouble Ticket 5-1  
**Síntoma:** No hay vecinos EIGRPv6 en un enlace punto a punto.

Diagnóstico:
```
show ipv6 interface g0/0
show ipv6 eigrp neighbors
```

Causas típicas:
- Falta `ipv6 eigrp 100`.
- IPv6 no habilitado globalmente.
- Router-id no configurado.
- Autenticación incorrecta.

Solución común:
```
ipv6 unicast-routing
ipv6 router eigrp 100
 router-id 2.2.2.2
 no shutdown

interface g0/0
 ipv6 eigrp 100
```

---

## Trouble Ticket 5-2  
**Síntoma:** Rutas EIGRPv6 aprendidas no aparecen en tabla.

Diagnóstico:
```
show ipv6 route
show ipv6 eigrp topology
```

Causas:
- Prefijo filtrado.
- Interfaz passive.
- AD menor por OSPFv3.
- Ruta es summary discard.
- Prefijo no permitido por prefix-list.

Solución típica:
```
ipv6 router eigrp 100
 no passive-interface g0/0
 no distribute-list prefix BLOCK in g0/1
```

---

# Resumen Final del Capítulo

- EIGRPv6 usa activación por interfaz, no network statements.  
- Vecinos usan direcciones link-local.  
- Debe habilitarse globalmente con `ipv6 unicast-routing`.  
- Named mode es preferido en ENARSI.  
- Resumen y rutas por defecto funcionan igual que IPv4 pero usando IPv6 prefix-lists.  
- Troubleshooting requiere revisar interfaces, AS, autenticación y filtros.

